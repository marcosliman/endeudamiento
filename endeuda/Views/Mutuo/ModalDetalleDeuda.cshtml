@model modelo.ViewModel.MutuoViewModel
@{
    ViewBag.Title = "Detalle de Deuda";
}
@{
    Layout = "~/Views/Shared/_Popup.cshtml";
}

<div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Detalle de Deuda</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card-body">
            <div class="row">
                <label for="inputEmail3" class="col-lg-12 col-form-label">Detalle al: @Model.FechaPrestamo</label>
                <div class="table-responsive mt-1">
                    <table class="table table-bordered table-hover dataTable dtr-inline" width="100%" id="grillaDeuda" data-order='[[ 0, "asc" ]]'>
                        <thead class="thead-light">
                            <tr>
                                <th>Item</th>
                                <th>Inicio de Periodo</th>
                                <th>Fin de Periodo</th>
                                <th>Días</th>
                                <th>Monto ($)</th>
                                <th>Intereses</th>
                                <th>Pago Amortización</th>
                                <th>Nuevo Préstamo</th>
                                <th>Fecha</th>
                                <th>Días</th>
                                <th>Intereses</th>
                                <th>Interés Total</th>
                                <th>Monto Final</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cerrar</button>
    </div>
</div>

<script>
    $(document).ready(function () {
        Deuda();
    });

    function Deuda() {
        var table = initTableP();
        table.ajax.reload(function (json) { });
    }

    function initTableP() {
        var table = $('#grillaDeuda').DataTable({
            "retrieve": true,
            'ajax': {
                "type": "POST",
                "url": '/Mutuo/ListProyectar_Read/',
                "data": function (d) {
                    d.idMutuo = "@Model.IdMutuo";
                    d.fechaProyeccion = "@Model.FechaPrestamo";
                },
                "dataSrc": ""
            },
            columnDefs: [
                { targets: '_all', className: 'align-middle' },
                {
                    targets: [4, 5, 6, 7, 10, 11, 12],
                    render: function (data, type, row) {
                        var numFormt = "";
                        if (data != null) {
                            var num = data.toString();
                            numFormt = SeparadorMiles(num);
                        }
                        return numFormt;
                    }
                }
            ],
            columns: [
                { "data": "item" },
                {
                    data: {
                        _: "FechaInicioStr",
                        sort: "FechaInicio"
                    }
                },
                {
                    data: {
                        _: "FechaTerminoStr",
                        sort: "FechaTermino"
                    }
                },
                { "data": "CantidadDias" },
                { "data": "Monto" },
                { "data": "Interes" },
                { "data": "MontoAmortizacion" },
                { "data": "MontoPrestamo" },
                {
                    data: {
                        _: "FechaNuevoStr",
                        sort: "FechaNuevo"
                    }
                },
                { "data": "CantidadDiasNuevo" },
                { "data": "InteresNuevo" },
                { "data": "InteresTotal" },
                { "data": "MontoTotal" }
            ]
        });

        return table;
    }

</script>
