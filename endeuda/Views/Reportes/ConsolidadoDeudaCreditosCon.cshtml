@{
    ViewBag.Title = "Reporte";
}
@{
    tesoreria.Helper.Seguridad seguridad = System.Web.HttpContext.Current.Session["Seguridad"] as tesoreria.Helper.Seguridad;
}

<div class="d-sm-flex align-items-center justify-content-between">
    <h5 class="h5 mb-0 text-gray-800">Reporte </h5>
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/Home/Inicio">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">Inicio</li>
    </ol>
</div>
<h6 class="h6 mb-0 text-gray-800">Consolidado Deuda por Créditos Estructurados con Garantía.</h6>
<br />
<div class="card card-outline card-info collapsed-card">

    <div class="card-header">
        <h3 class="card-title">Filtros</h3>
        <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-plus"></i>
            </button>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-sm-2">
                <select name="empresa" class="form-control">
                    <option>--Seleccione Empresa--</option>
                    <option value="1">Todas</option>
                    <option value="2">MAQSUR S.A.</option>
                    <option value="3">BIOMASA</option>
                    <option value="3">TECSUR</option>
                    <option value="3">MQS</option>
                    <option value="3">NOK</option>
                </select>
            </div>
            <div class="col-sm-2">
                <select name="banco" class="form-control">
                    <option>--Seleccione Banco--</option>
                    <option value="1">Todas</option>
                    <option value="2">BCI</option>
                    <option value="3">SANTANDER</option>
                    <option value="3">SCOTIABANK</option>
                </select>
            </div>
            <div class="col-sm-2">
                <select name="anio" class="form-control">
                    <option>--Seleccione Año--</option>
                    <option value="1">2021</option>
                    <option value="2">2022</option>
                    <option value="3">2023</option>
                    <option value="4">2024</option>
                    <option value="5">2025</option>
                    <option value="6">2026</option>
                    <option value="7">2027</option>
                    <option value="8">2028</option>
                    <option value="9">2029</option>
                    <option value="10">2030</option>
                    <option value="11">2031</option>
                    <option value="12">2032</option>
                </select>
            </div>
            <div class="col-sm-2">
                <select name="empresa" class="form-control">
                    <option>--Seleccione Mes--</option>
                    <option value="1">Enero</option>
                    <option value="2">Febrero</option>
                    <option value="3">Marzo</option>
                    <option value="4">Abril</option>
                    <option value="5">Mayo</option>
                    <option value="6">Junio</option>
                    <option value="7">Julio</option>
                    <option value="8">Agosto</option>
                    <option value="9">Septiembre</option>
                    <option value="10">Octubre</option>
                    <option value="11">Noviembre</option>
                    <option value="12">Diciembre</option>
                </select>
            </div>
            <div class="col-sm-2">

            </div>
            <div class="col-sm-2">
                <div class="row justify-content-end">
                    <button class="btn btn-info btn-sm " type="button" onclick="RefreshLista()"><i class="fa fa-cog"></i> Generar</button>
                </div>
            </div>
        </div>
    </div>

</div>
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Detalle</h3>
        <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
            </button>
        </div>
    </div>
    <div class="card-body">
        <label for="inputEmail3" class="col-lg-12 col-form-label">Consolidado Deuda por Créditos</label>
        <label for="inputEmail3" class="col-lg-12 col-form-label">Detalle al 31 de agosto del 2021.</label>
        <div class="row justify-content-end">
            <button class="btn btn-info btn-sm " type="button" onclick="RefreshLista()"><i class="far fa-download"></i> Exportar .XLS</button>
        </div>
        <div class="table-responsive">
            <table class="table table-bordered table-hover dataTable dtr-inline" width="100%" id="grillaEmpresa" data-order='[[ 0, "asc" ]]'>
                <thead class="thead-light">
                    <tr>
                        <th class="no-sort" width="3%">&nbsp;</th>
                        <th>Empresa</th>
                        <th>Banco</th>
                        <th>Deuda Inicial</th>
                        <th>Garantía</th>
                        <th>N° Crédito</th>
                        <th>Tasa (%)</th>
                        <th>Cuota Mes</th>
                        <th>Capital Pagado (cierre mes anterior)</th>
                        <th>Saldo Insoluto</th>
                        <th>Fecha de Inicio</th>
                        <th>Fecha de Término</th>
                    </tr>
                </thead>
                <tbody>
                    

                </tbody>
            </table>
        </div>
    </div>
</div>

    <!-- DataTable with Hover -->
    <script>
        $(document).ready(function () {
            AbrirMenu("ConsolidadoDeudaCreditosCon");
            //moment.locale('es');
            //$('#fecha').daterangepicker({
            //    autoUpdateInput: false,
            //    "locale": {
            //        format: "DD/MM/YYYY",
            //        "separator": " - ",
            //        "applyLabel": "Aplicar",
            //        "cancelLabel": "Limpiar",
            //        "fromLabel": "DE",
            //        "toLabel": "HASTA",
            //        "customRangeLabel": "Personalizar",
            //        "daysOfWeek": [
            //            "Dom",
            //            "Lun",
            //            "Mar",
            //            "Mie",
            //            "Jue",
            //            "Vie",
            //            "Sáb"
            //        ],
            //        "monthNames": [
            //            "Enero",
            //            "Febrero",
            //            "Marzo",
            //            "Abril",
            //            "Mayo",
            //            "Junio",
            //            "Julio",
            //            "Agosto",
            //            "Septiembre",
            //            "Octubre",
            //            "Noviembre",
            //            "Diciembre"
            //        ],
            //        "firstDay": 1
            //    }
            //});

            //$('#fecha').on('apply.daterangepicker', function (ev, picker) {
            //    $(this).val(picker.startDate.format('DD/MM/YYYY') + ' - ' + picker.endDate.format('DD/MM/YYYY'));
            //    //RefreshLista();
            //});


            //$('#fecha').on('cancel.daterangepicker', function (ev, picker) {
            //    $(this).val('');
            //    //RefreshLista();
            //});
            //$('#selectEmpresa').select2({
            //    placeholder: '---Seleccione Empresa---',
            //    language: "es",
            //    allowClear: true,
            //});
            //$('#frmEdit').validate({
            //    debug: false,
            //    errorElement: "em",
            //    errorContainer: $("#warning")
            //});
            //$('#perfiles').select2({
            //    theme: 'bootstrap4'
            //})
            //window.top.esconderCargando();
            initTable();
        });
        function RefreshLista() {
            var table = initTable();
            table.ajax.reload(function (json) { });
        }
        function initTable() {
            var table = $('#grillaEmpresa').DataTable({
                "retrieve": true,
                'ajax': {
                    "type": "POST",
                    "url": '/Reportes/ConsolidadoDeudaCreditosCon_Read/0',
                    "data": function (d) {

                    },
                    "dataSrc": ""
                },
                columns: [

                    { "data": "IdContrato" },
                    { "data": "RazonSocial" },
                    { "data": "NombreBanco" },
                    { "data": "DeudaInicial" },
                    { "data": "TipoGarantia" },
                    { "data": "NumeroContrato" },
                    { "data": "TasaAnual" },
                    { "data": "CuotaMes" },
                    { "data": "CapitalPagado" },
                    { "data": "SaldoInsoluto" },
                    { "data": "FechaInicio" },
                    { "data": "FechaTermino" }
                ]
            });

            return table;
        }
        function Success_dl(data) {
            esconderCargando();
            if (data.Estado == "0") {
                toastr.success(data.Mensaje);
                $('#modal-registro').modal('hide');
                RefreshLista();
            }
            else {
                toastr.error(data.Mensaje);
            }
        }
        function Failure_dl(data) {
            esconderCargando();
            toastr.error(data.Mensaje);
            $('#modal-registro').modal('hide');
        }

    </script>


